// hydrate
$serializer = {{ class }}::getSerializer();
$model = $serializer->hydrate(new {{ class }}(), $data);
$this->hydrateRelationships($model, $data);

// validate
$validator = $this->getValidator();
if ($validator !== null && !$validator->validate($model)) {
	return new NotValid([
		'errors' => $validator->getValidationFailures()
	]);
}

// dispatch
$event = new {{ class }}Event($model);
$this->dispatch({{ class }}Event::PRE_CREATE, $event);
$this->dispatch({{ class }}Event::PRE_SAVE, $event);
$model->save();
$this->dispatch({{ class }}Event::POST_CREATE, $event);
$this->dispatch({{ class }}Event::POST_SAVE, $event);
return new Created(['model' => $model]);