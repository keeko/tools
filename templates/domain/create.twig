// hydrate
$serializer = {{ class }}::getSerializer();
${{ model }} = $serializer->hydrate(new {{ class }}(), $data);
{% if validate %}

// validate
if (!${{ model }}->validate()) {
	return new NotValid([
		'errors' => ${{ model }}->getValidationFailures()
	]);
}
{% endif %}

// dispatch
$event = new {{ class }}Event(${{ model }});
$dispatcher = $this->getServiceContainer()->getDispatcher();
$dispatcher->dispatch({{ class }}Event::PRE_CREATE, $event);
$dispatcher->dispatch({{ class }}Event::PRE_SAVE, $event);
${{ model }}->save();
$dispatcher->dispatch({{ class }}Event::POST_CREATE, $event);
$dispatcher->dispatch({{ class }}Event::POST_SAVE, $event);
return new Created(['model' => ${{ model }}]);