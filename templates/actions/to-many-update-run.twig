$body = $request->getContent();
if (!isset($body['data'])) {
	throw new InvalidParameterException();
}
$data = $body['data'];

$id = $this->getParam('id');
${{ model }} = {{ class }}Query::create()->findOneById($id);

if (${{ model }} === null) {
	throw new ResourceNotFoundException('{{ model }} with id ' . $id . ' does not exist');
}

// remove all relationships before
{{ fk_class }}Query::create()->filterBy{{ class }}(${{ model }})->deleteAll();

// add them
foreach ($data as $entry) {
	if (!isset($entry['id'])) {
		throw new InvalidParameterException();
	}
	${{ foreign_model }} = {{ foreign_class }}Query::create()->findOneById($entry['id']);
	${{ model }}->add{{ foreign_class }}(${{ foreign_model }});
	${{ model }}->save();	
}


// run response
return $this->response->run($request, ${{ model }});